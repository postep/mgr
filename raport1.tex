\documentclass[a4paper]{article}
\usepackage{polski}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{geometry}
\usepackage{float}


\title{MGR - Raport 1}
\author{Jakub Postępski}

\begin{document}

\maketitle

\section{Problem}
Należy skompensować siłę grawitacji w układzie ze sprężyną.

\section{Obiekt}
Obiektem jest układ ze sprężyną i amortyzatorem. Na końcu zawieszona jest punktowa masa $m$ której grawitację należy skompensować. Przyjmujemy że dla użytkownika dostępne są pomiary położenia ($x$), prędkości ($\dot{x}$), przyspieszenia ($\ddot{x}$) oraz siły odczytanej przez czujnik.

Model obiektu można opisać układem równań różniczkowych:

\[
\begin{bmatrix}
    \dot{x} \\
    \ddot{x}
\end{bmatrix}
=
\begin{bmatrix}
    0 & 1 \\
    \frac{k}{m} & \frac{b}{m}
\end{bmatrix}
\begin{bmatrix}
	x \\
    \dot{x}
\end{bmatrix}
+
\begin{bmatrix}
    0 \\
    -g
\end{bmatrix}
+
\begin{bmatrix}
    0\\
    \frac{1}{m}
\end{bmatrix}F
\]

gdzie:
\begin{itemize}
	\item $x$ pozycja zawieszonej masy
	\item $k$ parametr sztywności
	\item $b$ parametr amortyzacji
	\item $m$ masa przedmiotu
	\item $g$ przyspieszenie ziemskie
	\item $a$ przyspieszenie które można dodać do układu
\end{itemize}

Symulację obiektu (rys. ) można wykonać dyskretyzując model metodamy ZOH. Czujnik siły można zasymulować biorąc przyspieszenie układu $\ddot{x}$ i mnożąć przez masę. W każdym kroku symulacji do odczytywanych wartości dodawany jest szum biały.

\section{Estymacja masy}
Estymacja masy działa na podstawie dwóch modeli. Model opisany w sekcji \ref{fs} działa dobrze gdy układ jest ustabilizowany. Model opisany w sekcji \ref{pos} działa dobrze gdy układ jest w ruchu. W celu poprawnej estymacji w dowolnym momencie pracy układu połączono dane z modeli przy wykorzystaniu logiki rozmytej (rys. ). Następnie zastosowano filtr dolnoprzepustowy w celu odfitrowania zakłóceń.
  
\subsection{Estymacja z czujnika siły}
\label{fs}
Siła odczytywana z czujnika siły jest sumą sił działających na masę. Kiedy masa się nie porusza w łatwy sposób można odczytać siłę grawitacji. W momencie ruchu układu z czujnika dostajemy sygnał zmienny. W celu uzyskania interesującej nas składowej stałej (siła grawitacji) możemy zastosować transformatę Fouriera. Jedną z własności tej transformaty jest fakt że uzyskana składowa stała jest średnią arytmetyczną sygnału. W praktyce w celu uzyskania siły grawitacji stosowana jest średnia krocząca która działa podobnie do filtru dolnoprzepustowego. Dodatkową zaletą stosowania tej metody jest możliwość odfiltrowania szumów pomiarowych.

\subsection{Estymacja z pozycji układu}
\label{pos}
Masa umieszczona w układzie może być odkryta na podstawie równań modelu. Dla układu ciągłego dostajemy równanie:
\[ m(t) = \frac{kx(t) + b\dot{x}(t)}{\ddot{x}+g-a}\]

W celu dyskretyzacji wprowadzamy za odpowiednie pochodne równania różnicowe oparte na metodzie Eulera:
\[\ddot{x} \approx \frac{x(k)-2x(k-1)+x(k-2)}{T^2}\]
\[\dot{x} \approx \frac{x(k)-x(k-1)}{T}\]
gdzie $T$ to czas próbkowania układu.

Estymacja zachowuje się dobrze w układzie bez szumów (rys. ). W układzie z szumami sensowne wyniki można uzyskać tylko przez zastosowanie optymalizacji minimalizującej błąd odczytu kilku ostatnich próbek.

\subsection{Estymacja z macierzy układu}
Przyjmując układ dyskretny postaci:
\[x(k+1) = Ax(k) + Bu(k)\]
ze znanymi stanami układu, sterowaniami oraz znaną macierzą $B$ poprzez zastosowanie pseudoinwersji macierzy możemy wyprowadzić 
\section{Kompensacja grawitacji}
Kompensacja polega na dodaniu do układu siły która przeciwdziała sile grawitacji masy. Pomijając niedokładności, układ ze skompensowaną siłą grawitacji zachowuje się tak jakby tej masy w układzie nie było. Nie powstają oscylacje, a układ stabilizuje się bardzo szybko w pożądanej pozycji.




\end{document}